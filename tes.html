<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        :root {
            --primary: #000000;
            --gray-dark: #444444;
        }

        .DagTo {
            margin-bottom: 8px;
            width: 100%;
            background: var(--gray-dark);
            border-radius: 2px;
            padding-bottom: 0;
        }

        .DagPlaArea {
            width: 100%;
            transition: width .2s;
            position: relative;
            padding: 0;
            overflow: hidden;
            line-height: 20px;
            border-bottom-right-radius: .3rem;
            border-bottom-left-radius: .3rem;
        }

        #server ul {
            list-style-type: none;
            margin: 0;
            padding: 0;
        }

        #server ul li {
            display: inline-block;
        }

        .DagPlayOpt {
            padding: 5px 10px;
            text-align: center;
            cursor: pointer;
            font-size: 12px;
            background: #ff4500;
            border-radius: 3px;
            margin: 0 5px 10px;
        }

        .DagPlayOpt.on {
            color: #fff;
            background: var(--primary);
        }

        .video-content {
            background: #000;
            overflow: hidden;
        }

        #pembed {
            max-width: 100%;
            height: 0;
            padding-bottom: 56.25%;
            position: relative;
        }

        .playerload {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            border: 10px solid transparent;
            border-top-color: #ff4500;
            border-bottom-color: #ff4500;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: translate(-50%, -50%) rotate(0deg);
            }
            100% {
                transform: translate(-50%, -50%) rotate(360deg);
            }
        }

        iframe {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            border: none;
        }

        .marquee-container {
            width: 100%;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 10px 0;
            font-size: 14px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .marquee {
            white-space: nowrap;
            overflow: hidden;
            flex: 1;
        }

        .marquee div {
            display: inline-block;
            padding-left: 100%;
            animation: marquee 25s linear infinite;
        }

        @keyframes marquee {
            from {
                transform: translateX(0);
            }
            to {
                transform: translateX(-100%);
            }
        }

        .time-display {
            margin-right: 20px;
            white-space: nowrap;
            font-family: 'Courier New', Courier, monospace;
            font-size: 16px;
            animation: fadeInOut 1s linear infinite alternate;
        }

        @keyframes fadeInOut {
            0% { opacity: 0.5; }
            100% { opacity: 1; }
        }

    </style>
    <title>Video Player</title>
</head>
<body>
    <div class="DagPlaArea DagTo">
        <div id="PlayVideo" class="video-content">
            <div id="embed_holder">
                <div class="player-embed" id="pembed">
                    <div class="playerload"></div>
                    <div class="pframe">
                        <iframe src="" frameborder="0" allow="encrypted-media" allowfullscreen="true" webkitallowfullscreen="true" mozallowfullscreen="true" allow="accelerometer; gyroscope; autoplay; encrypted-media; picture-in-picture;" referrerpolicy="no-referrer"></iframe>
                    </div>
                </div>
            </div>
        </div>
        <div class="marquee-container">
            <div class="time-display" id="timeDisplay"></div>
            <div class="marquee">
                <div>Pastikan koneksi internet Anda stabil. Disarankan untuk menggunakan Google Chrome agar tampilan lebih stabil. Jika Anda kehilangan koneksi atau mengalami kecepatan yang lambat, Anda dapat melakukan refresh untuk mendapatkan tautan yang lebih baru.</div>
            </div>
        </div>
    </div>
    <center>
        <div id="server">
            <ul id="serverList">
                <!-- Server options will be generated here -->
            </ul>
        </div>
    </center>

    <script>
        document.addEventListener("DOMContentLoaded", function() {
            const servers = [
                { name: "Server 1", embed: "https://example.com/embed1" },
                { name: "Server 2", embed: "https://example.com/embed2" },
                { name: "Server 3", embed: "https://example.com/embed3" }
            ];

            const serverList = document.getElementById('serverList');
            const iframe = document.querySelector("#pembed iframe");
            const playerLoad = document.querySelector(".playerload");
            let currentServerIndex = 0;

            function loadServer(index) {
                if (index >= servers.length) {
                    playerLoad.style.display = "none";
                    alert("All servers failed to load. Please try again later.");
                    return;
                }

                const embedURL = servers[index].embed;
                playerLoad.style.display = "block";  // Show loading animation
                iframe.src = embedURL;

                iframe.onload = function() {
                    playerLoad.style.display = "none";  // Hide loading animation when iframe loads
                };

                iframe.onerror = function() {
                    playerLoad.style.display = "none";  // Hide loading animation if iframe fails to load
                    alert(`Failed to load ${servers[index].name}. Trying next server...`);
                    loadServer(index + 1);  // Try next server
                };

                document.querySelectorAll('.DagPlayOpt').forEach(opt => opt.classList.remove('on'));
                serverList.children[index].firstChild.classList.add('on');
                currentServerIndex = index;
            }

            function getParameterByName(name, url = window.location.href) {
                name = name.replace(/[\[\]]/g, '\\$&');
                const regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
                    results = regex.exec(url);
                if (!results) return null;
                if (!results[2]) return '';
                return decodeURIComponent(results[2].replace(/\+/g, ' '));
            }

            const embedParam = getParameterByName('embed');
            if (embedParam) {
                playerLoad.style.display = "block";  // Show loading animation
                iframe.src = embedParam;

                iframe.onload = function() {
                    playerLoad.style.display = "none";  // Hide loading animation when iframe loads
                };

                iframe.onerror = function() {
                    playerLoad.style.display = "none";  // Hide loading animation if iframe fails to load
                    alert("Failed to load the video from the provided URL.");
                };
            } else {
                servers.forEach((server, index) => {
                    const li = document.createElement('li');
                    const div = document.createElement('div');
                    div.className = 'DagPlayOpt';
                    div.dataset.embed = server.embed;
                    div.innerHTML = `<span>${server.name}</span>`;
                    li.appendChild(div);
                    serverList.appendChild(li);

                    div.addEventListener('click', function() {
                        loadServer(index);
                    });

                    // Trigger click on the first server option
                    if (index === 0) {
                        div.click();
                    }
                });
            }

            // Function to update time in WIB
            function updateTime() {
                const now = new Date();
                const options = { timeZone: 'Asia/Jakarta', hour: '2-digit', minute: '2-digit', second: '2-digit' };
                const timeString = now.toLocaleTimeString('en-GB', options);
                document.getElementById('timeDisplay').textContent = `${timeString} WIB`;
            }

            // Update time every second
            setInterval(updateTime, 1000);
            updateTime();  // Initial call to set time immediately
        });
    </script>
</body>
</html>
