<html lang="en">
<head>
<meta charset="UTF-8">
<title>Live Stream Player</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta content='no-referrer' name='referrer'/>
<style>
html,
body {
    margin: 0;
    padding: 0;
    height: 100%;
    background-color: #000;
}

#player-wrapper {
    width: 100%;
    height: 100vh;
}
</style>
</head>
<body>

<div id="player-wrapper"></div>
<!-- Clappr core -->
<script src="//cdn.jsdelivr.net/npm/clappr@latest/dist/clappr.min.js"></script>
<!-- Level Selector plugin -->
<script src="//cdn.jsdelivr.net/gh/clappr/clappr-level-selector-plugin@latest/dist/level-selector.min.js"></script>

<script>
// Fungsi untuk mengambil parameter dari URL (LENGKAP)
function getParameterByName(name, url) {
    if (!url) url = window.location.href;
    name = name.replace(/[

$$$$

]/g, '\$&');
    const regex = new RegExp('[?&]' + name + '(=([^&#]*)|&|#|$)'),
        results = regex.exec(url);
    if (!results) return null;
    if (!results[2]) return '';
    return decodeURIComponent(results[2].replace(/\+/g, ' '));
}

document.addEventListener("DOMContentLoaded", function() {
    // Mengambil parameter URL stream dari query string
    var streamUrl = getParameterByName('stream_url');
    
     // Fallback ke nilai default jika parameter tidak ada
     var source = streamUrl || " "; 

     // Inisialisasi player dengan konfigurasi lengkap
     var player = new Clappr.Player({
         source: source,
         parentId: "#player-wrapper",
         mimeType: "application/x-mpegURL",
         autoPlay: true,
         mute: true,
         mediacontrol: { 
             seekbar: "#FFA500",
             buttons: "#FFFFFF"
         },
         height:"100%", 
          width:"100%",
          plugins:[LevelSelector],
          watermark:"",
          watermarkLink:"", 
          position:"top-right",
           language:"en",
           playback:{
               hlsjsConfig:{ debug : false },
                playInline : true ,
                 preload : "auto"
            }
      });

      // Debugging - tampilkan URL yang digunakan di console
      console.log("Stream URL:", source);
});
</script>

<!-- Pesan error jika JavaScript tidak support -->
<noscript>Browser Anda tidak mendukung JavaScript. Player streaming membutuhkan JS.</noscript>

</body>
</html>
